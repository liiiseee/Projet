package com.intiformation.gestion.model;

import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

/**
 * implémentation concrète de la couche dao du conseiller
 * @author IN-DF-029
 *
 */
public class ConseillerDaoImpl implements IConseillerDAO{

	/**
	 * permet de vérifier si un conseiller existe dans la bdd
	 */
	@Override
	public boolean isConseillerExists(String pMail, String pMdp) {
		
		PreparedStatement ps = null;
		ResultSet rs =null;
		try {
		// 1. requête SQL
		String isExistsReq = "SELECT COUNT(id_conseiller) FROM conseiller WHERE email=? AND mot_de_passe=?";
		
		// 2. requête préparée
		
			ps = this.connection.prepareStatement(isExistsReq);
			
		// 2. 1 passage de param
			ps.setString(1, pMail);
			ps.setString(2, pMdp);
			
			// exécution  + récup rés
			rs = ps.executeQuery();
			
			// 4. lecture du résultat
			rs.next();
			int verifIsExists =rs.getInt(1);
			
			//5. renvoi du résultat
			return (verifIsExists == 1)?true:false;
			
		} catch (SQLException e) {
			System.out.println("... erreur exécution requête isConseillerExists...");
			e.printStackTrace();
		}
		
		
		return false;
	}//end isConseillerExists()

}//end class
