package com.intiformation.gestionclients.dao;

import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.List;

import com.intiformation.gestionclients.model.Client;

/**
 * l'implémentation concrète de la dao du client
 * @author IN-DF-029
 *
 */
public class ClientDaoImpl implements IClientDAO{

	/**
	 * récup de la liste des clients de la bdd
	 */
	@Override
	public List<Client> getAllClients() {
		PreparedStatement ps = null;
		ResultSet rs =null;
		try {
		//req préparée
		
			ps = this.connection.prepareStatement("SELECT * FROM clients");
		
			// exécution + résultat
			rs = ps.executeQuery();
			List<Client> listeClients = new ArrayList<>();
			Client client = null;
			
			while (rs.next()) {
				client = new Client(rs.getInt(1),
									rs.getString(2),
									rs.getString(3),
									rs.getString(4),
									rs.getString(5),
									rs.getString(6),
									rs.getString(7));
				
				listeClients.add(client);
			}//end while
			
			return listeClients;
			
		} catch (SQLException e) {
			System.out.println("... erreur lors de l'exécution de la requête getAllClients de la DAO");
			e.printStackTrace();
		}
		
		return null;
	}//end getAllClients()

	
	/**
	 * ajout d'un client
	 */
	@Override
	public void ajouterClient(Client client) {
		// TODO Auto-generated method stub
		
	}

	/**
	 * modif d'un client
	 */
	@Override
	public void modifierClient(Client client) {
		// TODO Auto-generated method stub
		
	}

	@Override
	public void supprimerClient(int pIdClient) {
		// TODO Auto-generated method stub
		
	}

	/**
	 * récup d'un client par son id
	 */
	@Override
	public Client getClientById(int pIdClient) {
		PreparedStatement ps = null;
		ResultSet rs =null;
		try {
		//req préparée
		
			ps = this.connection.prepareStatement("SELECT * FROM clients WHERE id_client=?");
			ps.setInt(1, pIdClient);
		
			// exécution + résultat
			rs = ps.executeQuery();
			List<Client> listeClients = new ArrayList<>();
			Client client = null;
			
			
				client = new Client(rs.getInt(1),
									rs.getString(2),
									rs.getString(3),
									rs.getString(4),
									rs.getString(5),
									rs.getString(6),
									rs.getString(7));
				
			
			
			
			return client;
			
		} catch (SQLException e) {
			System.out.println("... erreur lors de l'exécution de la requête getClientById de la DAO");
			e.printStackTrace();
		}
		return null;
	}

}//end class
